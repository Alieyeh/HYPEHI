<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>hypehd.visualization &mdash; hypehd  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> hypehd
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../examples1.html">Examples 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples2.html">Examples 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../autoapi/index.html">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">hypehd</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">hypehd.visualization</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for hypehd.visualization</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">OPTICS</span><span class="p">,</span> <span class="n">DBSCAN</span><span class="p">,</span> <span class="n">KMeans</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>
<span class="kn">from</span> <span class="nn">lifelines</span> <span class="kn">import</span> <span class="n">KaplanMeierFitter</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>


<div class="viewcode-block" id="cluster_3d"><a class="viewcode-back" href="../../autoapi/hypehd/visualization/index.html#hypehd.visualization.cluster_3d">[docs]</a><span class="k">def</span> <span class="nf">cluster_3d</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">c_type</span><span class="o">=</span><span class="s1">&#39;k-means&#39;</span><span class="p">,</span> <span class="n">number</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">min_sample</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
               <span class="n">lab1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lab2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lab3</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;cluster3d&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots a three-dimensional graph of clusters for the three specified numerical columns.</span>
<span class="sd">    The type of clustering as well as some minor fine-tuning of clustering model</span>
<span class="sd">    are available.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        df : pd.DataFrame, mandatory</span>
<span class="sd">            The dataset that contains the feature that will be plotted.</span>
<span class="sd">        cols : list, mandatory</span>
<span class="sd">            A list with three element of type str which are the column names.</span>
<span class="sd">        c_type : str, optional</span>
<span class="sd">            The type of clustering model. The available options are DBSCAN, OPTICS</span>
<span class="sd">            and k-means. If no type is specified, k-means will be preformed.</span>
<span class="sd">        number : int, optional</span>
<span class="sd">            The number of clusters. This parameter is only used for k-means. The</span>
<span class="sd">            default value is the smallest number of clusters with an inertia value</span>
<span class="sd">            less than 50.</span>
<span class="sd">        min_sample : int, optional</span>
<span class="sd">            The minimum number of samples in a cluster. This parameter is only used</span>
<span class="sd">            for DBSCAN and OPTICS. The default value is 3.</span>
<span class="sd">        eps: float, optional</span>
<span class="sd">            The maximum distance between samples for them to fall into the same cluster.</span>
<span class="sd">            This parameter is only used for DBSCAN. The default value is 0.5.</span>
<span class="sd">        lab1 : str, optional</span>
<span class="sd">            The label for axis 1. The default option is the name of the column in</span>
<span class="sd">            the data frame.</span>
<span class="sd">        lab2 : str, optional</span>
<span class="sd">            The label for axis 2. The default option is the name of the column in</span>
<span class="sd">            the data frame.</span>
<span class="sd">        lab3 : str, optional</span>
<span class="sd">            The label for axis 3. The default option is the name of the column in</span>
<span class="sd">            the data frame.</span>
<span class="sd">        legend : bool, optional</span>
<span class="sd">            Show legend or not. default is False.</span>
<span class="sd">        path : str, optional</span>
<span class="sd">            The directory path to save the plot in. Plot will not be saved if not specified.</span>
<span class="sd">        name : str, optional</span>
<span class="sd">            Name of the plot. The default is cluster3d.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig : plt.figure</span>
<span class="sd">        ax : axes.Axes</span>
<span class="sd">        The figure and axes of the plot.</span>

<span class="sd">        Example</span>
<span class="sd">        --------</span>
<span class="sd">        &gt; cluster_3d(df = data, cols = [&#39;age&#39;,&#39;height&#39;,&#39;BMI&#39;], c_type = &quot;DBSCAN&quot;, lab1 = &quot;Age&quot;,</span>
<span class="sd">        lab2 = &quot;Height&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">c_type</span> <span class="o">=</span> <span class="n">c_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;Wrong number of columns&#39;</span>
    <span class="k">if</span> <span class="n">c_type</span> <span class="o">==</span> <span class="s1">&#39;optics&#39;</span><span class="p">:</span>
        <span class="n">clusters</span> <span class="o">=</span> <span class="n">OPTICS</span><span class="p">(</span><span class="n">min_samples</span><span class="o">=</span><span class="n">min_sample</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">cols</span><span class="p">])</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Clusters&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">clusters</span><span class="o">.</span><span class="n">labels_</span>
    <span class="k">elif</span> <span class="n">c_type</span> <span class="o">==</span> <span class="s1">&#39;dbscan&#39;</span><span class="p">:</span>
        <span class="n">clusters</span> <span class="o">=</span> <span class="n">DBSCAN</span><span class="p">(</span><span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">,</span> <span class="n">min_samples</span><span class="o">=</span><span class="n">min_sample</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">cols</span><span class="p">])</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Clusters&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">clusters</span><span class="o">.</span><span class="n">labels_</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">number</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">number</span> <span class="o">=</span> <span class="mi">15</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">15</span><span class="p">):</span>
                <span class="n">clusters</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">k</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">cols</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">clusters</span><span class="o">.</span><span class="n">inertia_</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">:</span>
                    <span class="n">number</span> <span class="o">=</span> <span class="n">k</span>
                    <span class="k">break</span>
            <span class="n">clusters</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">number</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">cols</span><span class="p">])</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Clusters&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">clusters</span><span class="o">.</span><span class="n">labels_</span>

    <span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">lab1</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">lab1</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">lab1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">cols</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">lab2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">lab2</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">lab2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">cols</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">lab3</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">lab3</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="n">lab3</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="n">cols</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">Clusters</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">cols</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">Clusters</span> <span class="o">==</span> <span class="n">s</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">cols</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">Clusters</span> <span class="o">==</span> <span class="n">s</span><span class="p">],</span> 
                   <span class="n">df</span><span class="p">[</span><span class="n">cols</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">Clusters</span> <span class="o">==</span> <span class="n">s</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">s</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">.png&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="cluster_2d"><a class="viewcode-back" href="../../autoapi/hypehd/visualization/index.html#hypehd.visualization.cluster_2d">[docs]</a><span class="k">def</span> <span class="nf">cluster_2d</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">c_type</span><span class="o">=</span><span class="s1">&#39;k-means&#39;</span><span class="p">,</span> <span class="n">number</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">min_sample</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
               <span class="n">lab1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lab2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;cluster2d&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots a two-dimensional graph of clusters for the two specified numercial columns.</span>
<span class="sd">    The type of clustering as well as some minor fine-tuning of clustering model</span>
<span class="sd">    are available.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        df : pd.DataFrame, mandatory</span>
<span class="sd">            The dataset that contains the feature that will be plotted.</span>
<span class="sd">        cols : list, mandatory</span>
<span class="sd">            A list with two element of type str which are the column names.</span>
<span class="sd">        c_type : str, optional</span>
<span class="sd">            The type of clustering model. The available options are DBSCAN, OPTICS</span>
<span class="sd">            and k-means. If no type is specified, k-means will be preformed.</span>
<span class="sd">        number : int, optional</span>
<span class="sd">            The number of clusters. This parameter is only used for k-means. The</span>
<span class="sd">            default value is the smallest number of clusters with an inertia value</span>
<span class="sd">            less than 50.</span>
<span class="sd">        min_sample : int, optional</span>
<span class="sd">            The minimum number of samples in a cluster. This parameter is only used</span>
<span class="sd">            for DBSCAN and OPTICS. The default value is 3.</span>
<span class="sd">        eps: float, optional</span>
<span class="sd">            The maximum distance between samples for them to fall into the same cluster.</span>
<span class="sd">            This parameter is only used for DBSCAN. The default value is 0.5.</span>
<span class="sd">        lab1 : str, optional</span>
<span class="sd">            The label for axis 1. The default option is the name of the column in</span>
<span class="sd">            the data frame.</span>
<span class="sd">        lab2 : str, optional</span>
<span class="sd">            The label for axis 2. The default option is the name of the column in</span>
<span class="sd">            the data frame.</span>
<span class="sd">        path : str, optional</span>
<span class="sd">            The directory path to save the plot in. Plot will not be saved if not specified.</span>
<span class="sd">        name : str, optional</span>
<span class="sd">            Name of the plot. The default is cluster2d.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig : plt.figure</span>
<span class="sd">        ax : axes.Axes</span>
<span class="sd">        The figure and axes of the plot.</span>

<span class="sd">        Example</span>
<span class="sd">        --------</span>
<span class="sd">        &gt; cluster_2d(df = data, cols = [&#39;age&#39;,&#39;height&#39;], c_type = &quot;OPTICS&quot;, lab1 = &quot;Age&quot;,</span>
<span class="sd">        lab2 = &quot;Height&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">c_type</span> <span class="o">=</span> <span class="n">c_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;Wrong number of columns&#39;</span>
    <span class="k">if</span> <span class="n">c_type</span> <span class="o">==</span> <span class="s1">&#39;optics&#39;</span><span class="p">:</span>
        <span class="n">clusters</span> <span class="o">=</span> <span class="n">OPTICS</span><span class="p">(</span><span class="n">min_samples</span><span class="o">=</span><span class="n">min_sample</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">cols</span><span class="p">])</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Clusters&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">clusters</span><span class="o">.</span><span class="n">labels_</span>
    <span class="k">elif</span> <span class="n">c_type</span> <span class="o">==</span> <span class="s1">&#39;dbscan&#39;</span><span class="p">:</span>
        <span class="n">clusters</span> <span class="o">=</span> <span class="n">DBSCAN</span><span class="p">(</span><span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">,</span> <span class="n">min_samples</span><span class="o">=</span><span class="n">min_sample</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">cols</span><span class="p">])</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Clusters&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">clusters</span><span class="o">.</span><span class="n">labels_</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">number</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">number</span> <span class="o">=</span> <span class="mi">15</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">15</span><span class="p">):</span>
                <span class="n">clusters</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">k</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">cols</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">clusters</span><span class="o">.</span><span class="n">inertia_</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">:</span>
                    <span class="n">number</span> <span class="o">=</span> <span class="n">k</span>
                    <span class="k">break</span>
        <span class="n">clusters</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">number</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">cols</span><span class="p">])</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Clusters&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">clusters</span><span class="o">.</span><span class="n">labels_</span>

    <span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">cols</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">cols</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">hue</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Clusters&#39;</span><span class="p">])</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">lab1</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">lab1</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">lab1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">cols</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">lab2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">lab2</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">lab2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">cols</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">.png&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="graph_3d"><a class="viewcode-back" href="../../autoapi/hypehd/visualization/index.html#hypehd.visualization.graph_3d">[docs]</a><span class="k">def</span> <span class="nf">graph_3d</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">ax1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ax2</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ax3</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">lab1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lab2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lab3</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;graph3d&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots a three-dimensional graph based on the three columns entered.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        df : pd.DataFrame, mandatory</span>
<span class="sd">            The dataset that contains the feature that will be plotted.</span>
<span class="sd">        ax1 : str, mandatory</span>
<span class="sd">            The name of the column for axis 1 containing the feature to be plotted.</span>
<span class="sd">        ax2 : str, mandatory</span>
<span class="sd">            The name of the column for axis 2 containing the feature to be plotted.</span>
<span class="sd">        ax3 : str, mandatory</span>
<span class="sd">            The name of the column for axis 3 containing the feature to be plotted.</span>
<span class="sd">        lab1 : str, optional</span>
<span class="sd">            The label for axis 1. The default option is the name of the column in</span>
<span class="sd">            the data frame.</span>
<span class="sd">        lab2 : str, optional</span>
<span class="sd">            The label for axis 2. The default option is the name of the column in</span>
<span class="sd">            the data frame.</span>
<span class="sd">        lab3 : str, optional</span>
<span class="sd">            The label for axis 3. The default option is the name of the column in</span>
<span class="sd">            the data frame.</span>
<span class="sd">        path : str, optional</span>
<span class="sd">            The directory path to save the plot in. Plot will not be saved if not specified.</span>
<span class="sd">        name : str, optional</span>
<span class="sd">            Name of the plot. The default is graph3d.</span>
<span class="sd">        </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig : plt.figure</span>
<span class="sd">        ax : axes.Axes</span>
<span class="sd">        The figure and axes of the plot.</span>

<span class="sd">        Example</span>
<span class="sd">        --------</span>
<span class="sd">        &gt; graph_3d(df = health_data, ax1 = &quot;sbp&quot;, ax2 = &quot;dbp&quot;, ax3 = &quot;chd&quot;, lab1 = &quot;SBP&quot;,</span>
<span class="sd">        lab2 = &quot;DBP&quot;, lab3 = &quot;CHD&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">lab1</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">lab1</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">lab1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">ax1</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">lab2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">lab2</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">lab2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ax2</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">lab3</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">lab3</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="n">lab3</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="n">ax3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">ax1</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">ax2</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">ax3</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">.png&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="f_test"><a class="viewcode-back" href="../../autoapi/hypehd/visualization/index.html#hypehd.visualization.f_test">[docs]</a><span class="k">def</span> <span class="nf">f_test</span><span class="p">(</span><span class="n">group1</span><span class="p">,</span> <span class="n">group2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the p-value given two groups&#39; data.</span>

<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            group1 : series or list, mandatory</span>
<span class="sd">                Containing continuous numbers for F-test from group 1.</span>
<span class="sd">            group2 : series or list, mandatory</span>
<span class="sd">                Containing continuous numbers for F-test from group 2.</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            p_value : float</span>
<span class="sd">                A number round to 3 decimal places.</span>

<span class="sd">            Examples</span>
<span class="sd">            --------</span>
<span class="sd">            &gt; a = [0.28, 0.2, 0.26, 0.28, 0.5]</span>
<span class="sd">            &gt; b = [0.2, 0.23, 0.26, 0.21, 0.23]</span>
<span class="sd">            &gt; f_test(a, b)</span>
<span class="sd">            0.004</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">group1</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">group2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">group2</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">f_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">group1</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">group2</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">nun</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">dun</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">p_value</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">stats</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">f_value</span><span class="p">,</span> <span class="n">nun</span><span class="p">,</span> <span class="n">dun</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">p_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="k">return</span> <span class="n">p_value</span></div>


<div class="viewcode-block" id="demo_graph"><a class="viewcode-back" href="../../autoapi/hypehd/visualization/index.html#hypehd.visualization.demo_graph">[docs]</a><span class="k">def</span> <span class="nf">demo_graph</span><span class="p">(</span><span class="n">var</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">input_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Show the count of categorical characteristic variables in each group and combine with a summary table.</span>
<span class="sd">    Show the boxplot of countinous characteristic variables in each group and combine with a smmary table.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        var : list, mandatory</span>
<span class="sd">            List of the characteristic variables. The list can include both categorical and countinous variables.</span>
<span class="sd">            The function can automatically detect its type and then use proper plot.</span>
<span class="sd">        input_data : pd.DataFrame, mandatory</span>
<span class="sd">            Input dataset name.</span>
<span class="sd">        group : names of variables in input_data, optional</span>
<span class="sd">            Grouping variables that will produce plottings and summary tables with different colors</span>
<span class="sd">            (e.g. treatment group).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tuple (fig_list, ax_list) : list of Figure, list of axes.Axes</span>
<span class="sd">        The matplotlib figures and axes containing the plots and summary tables.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        longitudinal_graph</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt; demo_graph(var=[&#39;gender&#39;,&#39;age&#39;], input_data=data, group=&quot;treatment&quot;)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">ax_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># iterate through different variables</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">var</span><span class="p">:</span>
        <span class="c1"># set up figure, axes</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">font_scale</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;Set2&quot;</span><span class="p">)</span>
        <span class="c1"># sort dataset</span>
        <span class="k">if</span> <span class="n">group</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dat</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="n">group</span><span class="p">,</span> <span class="n">col</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dat</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># check the type of variable (if numeric)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">input_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">):</span>
            <span class="c1"># generate boxplot</span>
            <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dat</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">group</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;v&quot;</span><span class="p">)</span>
            <span class="c1"># generate summary table (descriptive statistic for numeric variables)</span>
            <span class="k">if</span> <span class="n">group</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">summary</span> <span class="o">=</span> <span class="n">dat</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">group</span><span class="p">])[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">percentiles</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">])</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">summary</span> <span class="o">=</span> <span class="n">dat</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">percentiles</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">])</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
        <span class="c1"># check the type of variable (if categorical)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">summary</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
            <span class="c1"># generate count plot</span>
            <span class="c1"># generate summary table (percentage for categorical variables)</span>
            <span class="k">if</span> <span class="n">group</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dat</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">group</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="n">col</span><span class="p">)</span>
                <span class="n">summary</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dat</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">group</span><span class="p">])[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; (&quot;</span> \
                    <span class="o">+</span> <span class="nb">round</span><span class="p">(</span><span class="n">dat</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">group</span><span class="p">])[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;%)&quot;</span>
                <span class="n">summary</span> <span class="o">=</span> <span class="n">summary</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
                <span class="n">summary</span> <span class="o">=</span> <span class="n">summary</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">group</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dat</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">dodge</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([],</span> <span class="p">[])</span>
                <span class="n">summary</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dat</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span> \
                    <span class="s2">&quot; (&quot;</span> <span class="o">+</span> <span class="nb">round</span><span class="p">(</span><span class="n">dat</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;%)&quot;</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="c1"># combine summary table with plot</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">cellText</span><span class="o">=</span><span class="n">summary</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">rowLabels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">split</span><span class="p">()[:</span><span class="mi">3</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">summary</span><span class="o">.</span><span class="n">index</span><span class="p">],</span>
                  <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span> <span class="n">cellLoc</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
        <span class="c1"># format adjust</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Plot and summary table for </span><span class="si">{</span><span class="n">col</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
        <span class="c1"># append multiple plots into list</span>
        <span class="n">fig_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
        <span class="n">ax_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig_list</span><span class="p">,</span> <span class="n">ax_list</span></div>


<div class="viewcode-block" id="longitudinal_graph"><a class="viewcode-back" href="../../autoapi/hypehd/visualization/index.html#hypehd.visualization.longitudinal_graph">[docs]</a><span class="k">def</span> <span class="nf">longitudinal_graph</span><span class="p">(</span><span class="n">outcome</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">group</span><span class="p">,</span> <span class="n">input_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Show the scatter plot of outcome means over time in each group and combine with a summary table. Function for</span>
<span class="sd">    longitudinal data analysis.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        outcome : list, mandatory</span>
<span class="sd">            List of the continuous outcome(y) variables need to be plotted.</span>
<span class="sd">        time : names of variables in input_data, mandatory</span>
<span class="sd">            Time variables(x)(e.g. visit number).</span>
<span class="sd">        group : names of time variables in input_data, mandatory</span>
<span class="sd">            Grouping variables that will produce plottings and summary tables with different colors</span>
<span class="sd">            (e.g. treatment group).</span>
<span class="sd">        input_data : pd.DataFrame, mandatory</span>
<span class="sd">            Input dataset name.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tuple (fig_list, ax_list) : list of Figure, list of axes.Axes</span>
<span class="sd">        The matplotlib figures and axes containing the plots and summary tables.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        demo_graph</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt; longitudinal_graph(outcome=[&quot;change_from_baseline&quot;], time=&quot;visit&quot;, group=&quot;treatment&quot;, input_data=data)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">ax_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># get unique time point</span>
    <span class="n">time_uni</span> <span class="o">=</span> <span class="n">input_data</span><span class="p">[</span><span class="n">time</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="c1"># get unique group name</span>
    <span class="n">group_uni</span> <span class="o">=</span> <span class="n">input_data</span><span class="p">[</span><span class="n">group</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="c1"># iterate through different outcome variables</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">outcome</span><span class="p">:</span>
        <span class="c1"># generate summary table for mean value in each group</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">input_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="n">group</span><span class="p">,</span> <span class="n">time</span><span class="p">])[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="c1"># set up figure, ax</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">font_scale</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;Set2&quot;</span><span class="p">)</span>
        <span class="c1"># generate line plot</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">time</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="n">group</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">summary</span><span class="p">)</span>

        <span class="n">temp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="c1"># performing F-test between every two of the groups</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">time_uni</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">g1</span><span class="p">,</span> <span class="n">g2</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">group_uni</span><span class="p">)),</span> <span class="mi">2</span><span class="p">):</span>
                <span class="n">a</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s2">==</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">group</span><span class="si">}</span><span class="s2">==&#39;</span><span class="si">{</span><span class="n">group_uni</span><span class="p">[</span><span class="n">g1</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
                <span class="n">b</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s2">==</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">group</span><span class="si">}</span><span class="s2">==&#39;</span><span class="si">{</span><span class="n">group_uni</span><span class="p">[</span><span class="n">g2</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
                <span class="n">p_value</span> <span class="o">=</span> <span class="n">f_test</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
                <span class="n">row</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="n">i</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">group_uni</span><span class="p">[</span><span class="n">g1</span><span class="p">]</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">group_uni</span><span class="p">[</span><span class="n">g2</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">p_value</span><span class="p">]],</span>
                                   <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="s2">&quot;Compare&quot;</span><span class="p">,</span> <span class="n">col</span><span class="p">])</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">temp</span><span class="p">,</span> <span class="n">row</span><span class="p">])</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;Compare&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="n">summary</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">group</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">time</span><span class="p">)</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">summary</span><span class="p">,</span> <span class="n">temp</span><span class="p">])</span>

        <span class="c1"># combine summary table with line plot</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">cellText</span><span class="o">=</span><span class="n">summary</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">rowLabels</span><span class="o">=</span><span class="n">summary</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">],</span>
                  <span class="n">cellLoc</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
        <span class="c1"># format adjust</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Line plot and summary table for </span><span class="si">{</span><span class="n">col</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
        <span class="c1"># append multiple plots into list</span>
        <span class="n">fig_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
        <span class="n">ax_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig_list</span><span class="p">,</span> <span class="n">ax_list</span></div>


<div class="viewcode-block" id="relation"><a class="viewcode-back" href="../../autoapi/hypehd/visualization/index.html#hypehd.visualization.relation">[docs]</a><span class="k">def</span> <span class="nf">relation</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">gtype</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name_chi</span><span class="o">=</span><span class="s1">&#39;chiheatmap&#39;</span><span class="p">,</span> <span class="n">name_cor</span><span class="o">=</span><span class="s1">&#39;corheatmap&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots a heat-map of the relationship between features of the same type. If type of feature</span>
<span class="sd">    (numerical or categorical) is not specified, both heat-maps will be drawn. The measure used</span>
<span class="sd">    is chi-squared for categorical and correlation for numerical types. This function does not</span>
<span class="sd">    calculate the relationship between categorical and numerical values.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        df : pd.DataFrame, mandatory</span>
<span class="sd">            The dataset.</span>
<span class="sd">        gtype : int, optional</span>
<span class="sd">            Type of feature. 1 for categorical (chi-squared), 2 for numerical (correlation)</span>
<span class="sd">            any other number for both. The default is 3 (both).</span>
<span class="sd">        path : str, optional</span>
<span class="sd">            The directory path to save the plot in. Plot will not be saved if not specified.</span>
<span class="sd">        name_chi : str, optional</span>
<span class="sd">            Name of the plot for the categorical features. The default is chiheatmap.</span>
<span class="sd">        name_cor: str, optional</span>
<span class="sd">            Name of the plot for the numerical features. The default is corheatmap.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list : plt.figure, axes.Axes, p &lt;Object containing both figure and axes&gt;</span>
<span class="sd">        A list containing the figure and axes of each drawn plot.</span>

<span class="sd">        Example</span>
<span class="sd">        --------</span>
<span class="sd">        &gt; relation(df = health_data, gtype = 2, path = &quot;/Users/Person/Documents&quot;,</span>
<span class="sd">        name_cor = &quot;numerical_heatmap&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">to_return</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">gtype</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">chi</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span>
        <span class="n">num_cols</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">_get_numeric_data</span><span class="p">()</span><span class="o">.</span><span class="n">columns</span>
        <span class="n">cat_cols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">num_cols</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cat_cols</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">cat_cols</span><span class="p">:</span>
                <span class="n">con</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
                <span class="n">c</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">dof</span><span class="p">,</span> <span class="n">expected</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">chi2_contingency</span><span class="p">(</span><span class="n">con</span><span class="p">)</span>
                <span class="n">chi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">chi</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)))</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">14</span><span class="p">))</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;2g&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                        <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">YlOrBr</span><span class="p">,</span> <span class="n">xticklabels</span><span class="o">=</span><span class="n">cat_cols</span><span class="p">,</span> <span class="n">yticklabels</span><span class="o">=</span><span class="n">cat_cols</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">name_chi</span><span class="si">}</span><span class="s1">.png&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="c1"># pandas.DataFrame(chi, chi_cols, chi_cols)</span>
        <span class="n">to_return</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">gtype</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">14</span><span class="p">))</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">corr</span><span class="p">(),</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">name_cor</span><span class="si">}</span><span class="s1">.png&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="n">to_return</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">to_return</span></div>


<div class="viewcode-block" id="survival_analysis"><a class="viewcode-back" href="../../autoapi/hypehd/visualization/index.html#hypehd.visualization.survival_analysis">[docs]</a><span class="k">def</span> <span class="nf">survival_analysis</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">censor_status</span><span class="p">,</span> <span class="n">group</span><span class="p">,</span> <span class="n">input_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Show the kaplan-meier curve and combine with a median survival time summary.</span>
<span class="sd">    Function for survival data analysis.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        time : names of time variables in input_data, mandatory</span>
<span class="sd">            Time to event of interest.</span>
<span class="sd">        censor_status : names of variables in input_data, mandaory</span>
<span class="sd">            True(1) if the event of interest was observed, False(0) if the event was</span>
<span class="sd">            lost (right-censored).</span>
<span class="sd">        group : names of time variables in input_data, mandatory</span>
<span class="sd">            Grouping variables that will produce plottings and summary tables with</span>
<span class="sd">            different colors (e.g. treatment group).</span>
<span class="sd">        input_data : pd.DataFrame, mandatory</span>
<span class="sd">            Input dataset name.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig, ax :  Figure, axes.Axes</span>
<span class="sd">        The matplotlib figure and ax containing the plot and summary table.</span>


<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt; survival_analysis(time=&quot;time_to_event&quot;, censor_status=&quot;censor&quot;,</span>
<span class="sd">        group=&quot;treatment&quot;, input_data=data)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># remove records with missing time-to-event value</span>
    <span class="n">ana_data</span> <span class="o">=</span> <span class="n">input_data</span><span class="p">[</span><span class="n">input_data</span><span class="p">[</span><span class="n">time</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()]</span>
    <span class="n">group_list</span> <span class="o">=</span> <span class="n">ana_data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="n">group</span><span class="p">])[</span><span class="n">group</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="c1"># set up figure, ax</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="c1"># iterate through group</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">group_list</span><span class="p">:</span>
        <span class="c1"># data filter</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">ana_data</span><span class="p">[</span><span class="n">group</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span>
        <span class="c1"># draw KM plot</span>
        <span class="n">kmf</span> <span class="o">=</span> <span class="n">KaplanMeierFitter</span><span class="p">()</span>
        <span class="n">kmf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">ana_data</span><span class="p">[</span><span class="n">time</span><span class="p">][</span><span class="n">mask</span><span class="p">],</span> <span class="n">ana_data</span><span class="p">[</span><span class="n">censor_status</span><span class="p">][</span><span class="n">mask</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
        <span class="n">kmf</span><span class="o">.</span><span class="n">plot_survival_function</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
        <span class="c1"># get median survival time</span>
        <span class="n">row</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="n">i</span><span class="p">,</span> <span class="n">kmf</span><span class="o">.</span><span class="n">median_survival_time_</span><span class="p">]],</span>
                           <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">group</span><span class="p">,</span> <span class="s2">&quot;Median Survival Time&quot;</span><span class="p">])</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">temp</span><span class="p">,</span> <span class="n">row</span><span class="p">])</span>
    <span class="c1"># combine median survival table with plot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">cellText</span><span class="o">=</span><span class="n">temp</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">colLabels</span><span class="o">=</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="s2">&quot;Median survival time&quot;</span><span class="p">),</span>
              <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">],</span> <span class="n">cellLoc</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
    <span class="c1"># plot format adjust</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Survival of different </span><span class="si">{</span><span class="n">group</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.35</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="boxplot_grid"><a class="viewcode-back" href="../../autoapi/hypehd/visualization/index.html#hypehd.visualization.boxplot_grid">[docs]</a><span class="k">def</span> <span class="nf">boxplot_grid</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">col2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">col3</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A function for creating a grid of box plots with two options. One being that</span>
<span class="sd">    no column was specified, in this case the grid will be box plots of all numeric</span>
<span class="sd">    features in the dataset. The other being that three columns were specified, with</span>
<span class="sd">    one column being numeric and the others being categorical. In this case the grid</span>
<span class="sd">    will be of the numeric value on the basis of the two categorical values. If all</span>
<span class="sd">    three columns are specified, then the first case will be preformed.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        df : pd.DataFrame, mandatory</span>
<span class="sd">            The dataset holding the data that will be plotted.</span>
<span class="sd">        col1 : str, optional</span>
<span class="sd">            The categorical column that the grid will be split based on.</span>
<span class="sd">        col2 : str, optional</span>
<span class="sd">            The categorical column on the x-axis of each plot.</span>
<span class="sd">        col3 : str, optional</span>
<span class="sd">            The numerical column on the y-axis of each plot.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig, ax :  Figure, array of axes.Axes</span>
<span class="sd">        The matplotlib figure and axes containing the plots.</span>


<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt; boxplot_grid(df=health_data, col1=&quot;months&quot;, col2=&quot;sex&quot;, col3=&quot;BMI&quot;)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">col1</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">col2</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">col3</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">num_cols</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">_get_numeric_data</span><span class="p">()</span><span class="o">.</span><span class="n">columns</span>
        <span class="n">sizex</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">num_cols</span><span class="p">)))</span>
        <span class="n">marg</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">num_cols</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">sizex</span> <span class="o">*</span> <span class="n">sizex</span><span class="p">))</span> <span class="o">/</span> <span class="n">sizex</span>
        <span class="k">if</span> <span class="n">marg</span><span class="o">.</span><span class="n">is_integer</span><span class="p">():</span>
            <span class="n">sizey</span> <span class="o">=</span> <span class="n">sizex</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">marg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sizey</span> <span class="o">=</span> <span class="n">sizex</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">marg</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">sizey</span><span class="p">,</span> <span class="n">sizex</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">num_cols</span><span class="p">)):</span>
            <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">num_cols</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">num_cols</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span>
    <span class="k">elif</span> <span class="n">col1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">col2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">col3</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ordered</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col1</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
        <span class="n">wrap</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ordered</span><span class="p">)))</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">FacetGrid</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="n">col1</span><span class="p">,</span> <span class="n">col_order</span><span class="o">=</span><span class="n">ordered</span><span class="p">,</span> <span class="n">col_wrap</span><span class="o">=</span><span class="n">wrap</span><span class="p">)</span>
        <span class="n">g</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">,</span> <span class="n">col2</span><span class="p">,</span> <span class="n">col3</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;muted&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">():</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelbottom</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">g</span></div>


<div class="viewcode-block" id="pie"><a class="viewcode-back" href="../../autoapi/hypehd/visualization/index.html#hypehd.visualization.pie">[docs]</a><span class="k">def</span> <span class="nf">pie</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;pie_chart&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Draws a pie chart of the specified column. If the path is given the png file of</span>
<span class="sd">    the chart will be saved under the name of pie_chart.png at the specified path.</span>
<span class="sd">    This chart should be used for columns with discrete values.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        df : pd.DataFrame, mandatory</span>
<span class="sd">            The dataset that contains the feature that will be plotted.</span>
<span class="sd">        col : str, mandatory</span>
<span class="sd">            The name of the column containing the feature to be plotted.</span>
<span class="sd">        path : str, optional</span>
<span class="sd">            Path to the directory that the png file of the chart will be</span>
<span class="sd">            saved in. If left empty, the file will not be saved.</span>
<span class="sd">        name : str, optional</span>
<span class="sd">            Name of the png image of the chart. The default is pie_chart.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ax : axes.Axes</span>
<span class="sd">        The axes of the plot.</span>

<span class="sd">        Example</span>
<span class="sd">        --------</span>
<span class="sd">        &gt; pie(df = demographic_data, col = &quot;sex&quot;,</span>
<span class="sd">        path = &quot;/Users/Person/Documents&quot;, name = &quot;demo_pie&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">total</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">fmt</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{:.1f}</span><span class="s1">%</span><span class="se">\n</span><span class="si">{:.0f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">total</span> <span class="o">*</span> <span class="n">x</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span>

    <span class="n">colors</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;Spectral&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">autopct</span><span class="o">=</span><span class="n">fmt</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">.png&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Jiayi Wang, Sarabandi Moghaddam Alieyeh.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>